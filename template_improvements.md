have separate code for training and app

